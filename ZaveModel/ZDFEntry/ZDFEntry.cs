///////////////////////////////////////////////////////////
//  ZDFEntry.cs
//  Implementation of the Interface IZDFEntry
//  Generated by Enterprise Architect
//  Created on:      28-Mar-2016 8:22:27 AM
//  Original author: Moshe
///////////////////////////////////////////////////////////

using System;
using System.Collections.Generic;
using System.Text;
using System.IO;
using System.ComponentModel;
using System.Linq;
using ZaveGlobalSettings.Data_Structures;
using Prism.Mvvm;
using ZaveGlobalSettings.Data_Structures.ZaveObservableCollection;
using ZaveModel.ZDFColors;

namespace ZaveModel.ZDFEntry {

    using CommentList = ObservableImmutableList<IEntryComment>;

    public class ZDFEntry : BindableBase, IZDFEntry
    {


        

        

        private int _id;
        public int ID { get { return _id; } }

        

        public ZDFEntry()
        {
            m_IEntryComment = new CommentList();
            //Source = new ZaveGlobalSettings.Data_Structures.SelectionState();
            _id = ZDF.ZDFSingleton.setID();
            HColor = new ColorCategory(default(System.Drawing.Color), "");
            _page = "";
            _name = "";
            _text = "";
            _dateModified = default(DateTime);
            _format = default(SrcType);
        }

        public ZDFEntry(SelectionState src) : this()
        {
            m_IEntryComment = new CommentList();

            src.Comments.ForEach(item => Comments.Add(item as IEntryComment));

            _id = src.ID;
            _page = src.SelectionPage;
            _name = src.SelectionDocName;
            _text = src.SelectionText;
            _dateModified = src.SelectionDateModified;
            _format = src.srcType;
            _hColor = new ColorCategory(src.Color, src.Color.Name);
            
            
        }

        ~ZDFEntry()
        {

        }

        public SelectionState toSelectionState()
        {
            return new SelectionState( this.ID, this.Name, this.Page, this.Text, this.DateModified, this.HColor.Color, this.Format, this.Comments.ToList<object>());
        }


        #region Properties
        private ColorCategory _hColor;
        public ColorCategory HColor
        {
            get { return _hColor; }
            set
            {
                SetProperty(ref _hColor, value);
            }

        }

        //private ZaveGlobalSettings.Data_Structures.SelectionState _source;
        //public ZaveGlobalSettings.Data_Structures.SelectionState Source
        //{
        //    get { return _source; }
        //    set
        //    {
        //        _source = value;
        //        //OnPropertyChanged("Source", Source);
        //    }
        //}

        private string _page;
        public string Page
        {
            get { return _page; }
            set
            {
                SetProperty(ref _page, value);
            }
        }

        private string _text;
        public string Text
        {
            get { return _text; }
            set
            {
                SetProperty(ref _text, value);
            }
        }

        private DateTime _dateModified;
        public DateTime DateModified
        {
            get { return _dateModified; }
            set
            {
                SetProperty(ref _dateModified, value);
            }
        }

        private SrcType _format;
        public SrcType Format
        {
            get { return _format; }
            set
            {
                SetProperty(ref _format, value);
            }
        }

        private string _name;
        public string Name
        {
            get { return _name; }
            set
            {
                SetProperty(ref _name, value);
            }
        }


        private CommentList m_IEntryComment;

        public CommentList Comments
        {
            get { return m_IEntryComment; }
            set { SetProperty(ref m_IEntryComment, value); }
        }

        #endregion


    }

    //end ZDFEntry


}//end namespace ZDFEntry